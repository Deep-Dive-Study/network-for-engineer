# 5.3장

# 라우팅 설정 방법

### 다이렉트 커넥티드

목적지가 다이렉트 커넥티드라면 L2 통신으로 목적지에 도달한다. 이때 목적지가 외부 네트워크라면 통신이 불가능 하다. (스태틱 라우팅, 다이나믹 라우팅에서 얻은 정보 필요)

이 때 외부 네트워크 라우팅 정보가 있더라도 커넥티드 정보를 잘못 입력하면 외부와 통신할 수 없다. 따라서, IP 주소를 잘못 설정하거나, 서브넷 마스크를 다르게 설정하면 잘못 입력되어 통신이 안될 수 있다.

### 스태틱 라우팅

네트워크 정보를 쉽게 추가하고 제어할 수 있는 가장 강력한 방법이다. 다이렉트 커넥티드를 제외하고 우선순위가 가장 높다.

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/364a0823-07da-4e7b-94f3-d0fd810b6bc7)

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/39db3b77-bea6-455a-b8a5-3ddcf2c2bdad)

`ip rout 20.20.20.0 255.255.255.0 1.1.1.2` 이 명령어는 20.20.20.20으로 가려면 1.1.1.2로 보내라는 뜻이다. 이런 경우 라우팅 테이블은 1.1.1.0에 대한 네트워크만 존재하는데, 20.20.20.0으로 가는 라우팅 정보가 없어 패킷이 버려지기 때문이다.

사내 네트워크에선 스태틱 라우팅으로 처리할 수 있지만, 네트워크 규모가 커지면 어려움이 있다. 이런 경우 대용량의 인터넷 라우팅 전용 라우터가 필요한데, 보통 통신사같은 인터넷 사업자가 운영한다.

일반적인 회사의 라우터는 인터넷 사업자로부터 회선을 임대해 사용하는 것이기 때문에 모든 인터넷 경로를 받아 처리하는 것은 부적절하다. 이런 경우 디폴트 라우팅을 사용하면 좋다.

디폴트 라우팅 : 서브넷 마스크가 모두 0인 스태틱 라우팅을 뜻한다. 즉 모든 패킷을 목적지로 보내겠다는 뜻.

### 다이나믹 라우팅

SPoF를 방지하기 위해 여러 경로를 유지하는 경우 스태틱 라우팅만으로는 신속한 대응이 어렵다. 

대체 경로를 설정하거나 네트워크가 많아지면, 스태틱  라우팅으로 관리하기 어렵기 때문에 다이나믹 라우팅을 사용해 라우터끼리 정보를 교환하여 최신 경로 정보를 유지한다. 교환 프로토콜에는 여러가지가 있는데. 최근에는 BGP, OSPF를 주로 사용한다.

유니캐스트/멀티캐스트로 나눌 수 있고, 각 역할과 동작으로 분류할 수 있다.

**역할**

일반적으로 라우팅 프로토콜은 유니캐스트 프로토콜을 말하는데, 인터넷에는 AS 라는 자율 시스템이 존재한다. AS 내부에서 사용하는 프로토콜을 IGP, AS 간 통신에 사용하는 프로토콜을 EGP라고한다.

AS 간 통신에서는 조직 간 정책이 중요하기 때문에 EGP 는 이런 통신을 정책적으로 조정한다.

**동작**

IGP 라우팅 프로토콜은 크게 디스턴스 벡터와 링크 스테이트로 나뉜다.

디스턴스 벡터 : 인접한 라우터 경로 습득 (RIP, BGP, IGRP, EIGRP)

인접하지 않은 라우터는 인접한 라우터로부터 계산된 정보를 받기 때문에 리소스를 적게쓴다. 대신 멀리있는 라우터의 정보를 얻기까지 시간이 오래 걸린다.

링크 스테이트 : 연결된 링크 상태 교환 (OSPF, IS-IS)

링크 상태를 교환하기 때문에 직접적인 상태정보를 받을 수 있다. 이후 SPF 알고리즘으로 최단경로 트리를 만든다. 경로 변화를 빨리 감지하지만, CPU와 메모리 리소스를 많이 사용한다.

RIP 은 소형 네트워크에서 많이 사용되었지만, 여러 제약 때문에 EIGRP 를 사용하다가. 특정 업체 장비에서만 사용할 수 있었기에 최근에는 BGP를 사용한다.
