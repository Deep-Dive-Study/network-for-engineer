# 13장

네트워크는 단순히 호스트와 호스트간 통신이 가능하도록 하는 인프라를 뜻한다. 하지만, 단순히 통신만 한다고 끝나는게 아니고, 장애나 보안과도 관련이 깊다.

# 2/3계층 네트워크

### 2계층 네트워크

2계층으로만 이루어진 호스트가 동일한 네트워크를 뜻한다. (게이트웨이 필요없음)

하나의 브로드캐스트 도메인이 된다. 2계층에선 루프를 제거하고, 논블로킹 구조를 만들어야 한다.

### 3계층 네트워크

3계층으로만 이루어진 IP 라우팅을 사용하는 네트워크를 뜻한다. 라우팅을 사용하기 때문에 루프 문제가 없으며, ECMP 라우팅 기능을 사용해 전체 네트워크 인프라 대역폭을 사용할 수 있다.

장비마다 다른 네트워크를 가지고 있어 브로드캐스트로 상대방을 찾을 수 없어 VxLAN같은 오버레이 기술을 사용해야 한다.

# 3 계층 아키텍처

Core - Aggregation - Access로 이루어져 있으며 이는 정통적인 네트워크 디자인 기법이다.

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/11702f22-bc9b-4720-b0de-fff37f83ec59)

호스트가 직접 연결된 엑세스 계층에 스위치가 있다.

스위치를 집선하는 애그리게이션 스위치가 있다

코어 계층 스위치는 애그리게이션 스위치를 다시 모아 통신하도록 연결해준다.

상위 레이어로 갈수록 장비들이 집선되어 높은 대역폭이 필요하다.

# 2 계층 아키텍처

### 스파인-리프

데이터 센터 디자인으로 많이 사용하는 방법이다.

하단 호스트와 연결되는 리프 스위치는 상단 스파인 스위치와 연결된다.

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/07a7ac8c-c235-4af6-8015-661fcbe4ab3a)

리프와 스파인 스위치간에 스패닝 트리가 동작하지 않고 모든 링크를 사용해 트래픽을 전송한다.

North-South라고 부르는 트래픽이 주였던 과거와 달리 대용량 분산 처리기술이 많이 사용되는 데이터 센터에선 내부 통신량이 급증했다.

서버 계층이 복잡할수록 East-West 트래픽이 많아져 성능 지연이 발생할 수 있다.

스파인-리프 네트워크는 모든 통신간 홉이 동일하기 때문에 트래픽 흐름이 일정하다는 장점이 있다.

근래는 서버 가상화, 빅데이터, MSA같이 서버간 트래픽을 증가시키는 요인들이 많다

### L2 패브릭

스파인-리프를 2계층으로 구성하는 구조이다. 루프에 대한 제약때문에 TRILL, SPB같은 프로토콜을 사용한다.

### L3 패브릭

스파인-리프를 3계층으로 구성하는 구조이다. 스파인과 링크사이에 라우팅이 활성화 되어있고, 모든 링크가 활성화되어있다.

하단 리프 네트워크가 각각 다른 네트워크를 갖기 때문에 가상화 서버의 마이그레이션이나 IP 이동이 보장되는 네트워크를 구성할 수 있다.

# 데이터센터 Zone, PoD 내부망, DMZ망, 인터넷망

데이터센터는 보안과 관리상 이유로 데이터 센터망을 분리 설계한다.

### 인터넷망

외부에서 데이터 센터에 접근하도록 구성된 인터넷 망을 뜻한다.

KT, LG같은 통신국에서 회선을 받아 연동해놓는다.

### 공인망(DMZ)

데이터 센터에서 외부 사용자에게 직접 노출되는 서버들이 모인 망

### 내부망(사내/사설)

공인망의 정반대로 센터 내부나 사내에서만 접근할 수 있는 네트워크, 외부로 나가려면 NAT를 사용해야한다.

### DB망

개인정보를 취급할 수 있기 때문에 보안강화를 위해 별도의 망을 만들기도 한다.

공인망 - 방화벽 - 내부망 - 방화벽 - DB망 식으로 구성

### 대외망

회사 대 회사로 연동을 위해 별도의 전용선 또는 VPN을 만든다. 보안이 중요한 경우 전용 회선과 VPN을 동시에 사용하기도 한다.

### 관리망(OoB)

장비 자체를 관리하기 위한 네트워크 망이다. 서비스망과 큰 차이가 없다.

# 케이블링과 네트워크

데이터 센터에는 스토리지와 같은 장비를 수용하는 Rack이 많다.

### ToR(Top of Rack)

랙 상단에 개별적으로 설치되는 스위치 구성을 뜻한다.

일반적으로 랙 최상단에 ToR을 구성하고 랙에 있는 서버를 연결한다.

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/e272ab8d-1b80-4ad6-98ec-5d886580e976)

동일하거나 인접한 랙에 있으므로 케이블의 길이나 복잡성이 줄어든다.

EoR 구성보다 스위치가 많이 필요해 관리 포인트가 늘어난다. → 운영비용도 증가

미사용 포트가 늘어날 수 있다.

### EoR(End of Row)

서버 랙과 네트워크 장비 랙을 분리한 구성

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/667c2f1e-4d16-4f10-aabc-4d8719d0c862)

대형 섀시 스위치에서 라인 카드를 추가하는 방식으로 포트 수를 증가시킬 수 있어 스위치 장비수가 줄어든다.

서버와 케이블 구성이 멀어지고 복잡해진다. → 구축비용 증가

### MoR(Middle of Row)

ToR과 EoR의 사이로 네트워크 장비 랙 행 끝이 아닌 중간에 두는 경우.

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/7fbaf51f-105e-4e72-a250-ba850baa9729)
