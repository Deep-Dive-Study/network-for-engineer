## 3.1 유니, 멀티, 브로드, 애니 캐스트

네트워크에서 출발지 → 목적지로 데이터를 전송할 때 사용하는 통신방법은 다음과 같다.

**유니캐스트**

출발지와 목적지가 명확히 정해진 1:1 통신 방식

실제로 대부분의 통신은 유니캐스트 방식이다.

**브로드캐스트**

목적지의 주소가 ALL로 표기되어 있는 통신 방식으로 동일 네트워크에 모든 호스트에 패킷을 전달할때 사용.
유니캐스트로 통신하기 전에 상대방의 정확한 위치를 알기위해 사용한다.

**멀티캐스트**

해당 그룹에 속한 다수의 호스트로 패킷을 전송한다. 
사내방속이나 증권시세, IPTV와 같은 실시간 방송을 사용한다.

**애니캐스트**

주소가 같은 호스트중에 가장 가깝거나 효율적으로 서비스할 수 있는 호스트와 통신하는 방식이다.

가장 가까운 DNS 서버를 찾거나, 가장 가까운 게이트웨이를 찾는 애니캐스트 게이트웨이를 사용하기도 한다.

최초 통신은 1:1로 유니캐스트와 애니캐스트가 동일하지만 통신할 후보자는 다르다. 유니캐스트는 정확한 출발지와 목적지가 있지만, 애니캐스트는 같은 목적지 주소를 가진 서버가 여러대여서 다수의 후보군이 있다.

현재는 IPv4 기반의 주소체계가 사용되는데, IPv6에선 브로드캐스트가 존재하지 않고 링크 로컬 멀티캐스트로 대체된다.

### 정리

**목적지의 주소**로 구분한다는 것이 중요하다.

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/519d9452-1304-4f94-9452-d48237fe9d12)

* BUM트래픽 (Broadcast, Unknown Unicast, Multicast)

서로 다른 종류의 트래픽이지만, 네트워크에서 동작은 서로 비슷하다.

Unknown unicast는 유니캐스트이므로 목적지가 명확하다. 하지만 스위치 입장에서 Unknown이어서 패킷을 모든 포트로 전송하는 경우를 뜻한다.

이때는 유니캐스트이지만 실제로 겉에선 브로드캐스트에 가깝기 때문이다. 따라서 불필요한 BUM 트래픽이 많아지면 네트워크 성능이 저하된다.

이더넷 환경에선 ARP 브로드캐스트를 먼저 보내고 통신을 시작하기때문에 BUM트래픽이 자주 발생하지 않는다.

## MAC 주소 (Media Access Control)

2계층 통신을 위해 네트워크 인터페이스에 할당된 물리적인 고유 식별자를 뜻한다.

MAC 주소는 48비트의 16진수 12자리로 표현이 된다. 48비트 중에서도 앞 24, 뒤 24비트로 나누어 구분하는데 앞의 24비트는 OUI로 제조사코드를 뜻하고, 뒤 24비트는 UAA로 제조사에서 할당한 값이다.

* MAC주소가 유일한 값이라고 생각하지만, 실수나 의도적으로 중복시키는 경우도 있다.
MAC주소는 라우터에서 변경되기 떄문에 동일한 네트워크에서만 중복되지 않으면 문제가 없기 때문

* MAC주소 변경
NIC에 MAC주소가 고정되어 있지만, 운영체제에서 변경할 수 있는 경우도 있음

### MAC 동작

2계층에서 전기 신호를 데이터 형태로 변경하고 도착지 MAC주소를 확인한다. 이때 본인의 MAC주소(브로드, 멀티캐스트 그룹)와 다르면 패킷을 폐기한다.

브로드 캐스트 주소는 OS에서 처리하기 때문에 시스템에 부하가 작용한다.

## IP 주소

논리적인 주소를 뜻하며 3계층에서 사용된다. IP를 포함한 3계층 주소에는 다음과 같은 특징이 있다.

1. 사용자가 변경 가능한 논리주소이다.
2. 주소에 레벨이 있다.(네트워크+호스트)

### 주소 체계

IPv4
32비트로 이루어져 있으며 4개의 옥텟으로 나뉘어져 있다.

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/33160e29-7450-43e3-8804-95b738ac1966)
![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/347b2959-9479-4145-9de3-136ae4175664)

네트워크 주소와 호스트 주소로 레벨을 나누는데, 구분하는 경계점이 고정되어있지 않다.(몇번째 옥텟까지 사용하는지에 따라 다름) 이 구분자를 서브넷 마스크라 한다.

구분자가 고정되어있지 않으면 네트워크의 크기가 달라질 수 있다. 따라서 주소를 절약할 수 있다.

* 사용 가능한 호스트 개수 파악하기
맨 앞 옥텟이 0~127이면 A클래스 - 2^24 - 2
맨 앞 옥텟이 128~191이면 B클래스 - 2^16 - 2
첫 앞 옥텟이 192~223이면 C클래스 - 2^8 - 2

클래스(옥텟) 단위로 주소와 호스트를 나누게 되면 네트워크를 세밀하게 분할할 수 없기 때문에 **비트 단위로 네트워크를 상세히 분할**하게 된다.
이에는 세가지 방법을 사용하는데

- 서브네팅(네트워크와 호스트주소를 구분자로 나눠 사용하는법)

![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/702aa9f5-8ca0-4521-b4c7-759afb192d08)

위 사진의 경우 범위는 2^6 -2 = 62개(처음은 네트워크주소 마지막은 브로드캐스트주소)

1인 부분은 네트워크, 0인 부분은 호스트 영역이다.

- 사설 IP주소(가장 많이 쓰임)
인터넷에 접속하려면 IP 주소를 할당받아야 하는데, 인터넷에 접속하지 않거나 NAT 기술을 사용할 경우 사설 IP를 이용할 수 있다. (ex. 공유기)
- IPv6

### 네트워크 설계

네트워크는 2의 지수배로 커지므로 적절히 할당하는게 중요하다.

16개의 네트워크가 필요하면 2^5를 사용해야 하는데, 네트워크 장비주소와 브로드캐스트 주소가 있기 때문이다.

네트워크를 할당할 때 IP할당을 잘 설계해야 관리하기 쉽고 장비 성능도 향상된다.

- Bogon IP
    
    여러가지 목적으로 IP를 예약해둔 주소를 뜻한다.
    
    인터넷에서 동작하는 라우터에는 Bogon IP에 대한 정보가 없다. 따라서 이 IP들과의 통신 시도가 있다면 필터링 하는것이 좋다.
    
    ![image](https://github.com/Deep-Dive-Study/network-for-engineer/assets/85796588/73eeb781-9970-4785-9774-a414dcd30c84)  
